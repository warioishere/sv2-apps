# TpConfig Component

Template Provider Configuration UI component for sv2-tp settings.

## Overview

This component provides a user-friendly interface for configuring the Template Provider (sv2-tp) that connects to Bitcoin Core and provides block templates to JD-Client.

## Features

- **Bitcoin Core Source Selection**: Choose between integrated Docker containers (mainnet/testnet) or custom host paths
- **Network Configuration**: Select Bitcoin network (mainnet, testnet, signet, regtest)
- **Listen Address**: Configure where sv2-tp listens for JD-Client connections
- **Fee Settings**: Set fee check interval and minimum fee rate
- **Log Level**: Configure logging verbosity
- **Real-time Path Validation**: Validates custom Bitcoin Core socket paths
- **Configuration Preview**: Shows current configuration before saving
- **Status Integration**: Displays TP running status and prevents editing while running

## Usage

### Import and Use

```tsx
import { TpConfig } from '../components/TpConfig';

function App() {
  return <TpConfig />;
}
```

### Required Backend Endpoints

The component expects the following API endpoints:

1. **GET** `/api/tp/config/current` - Load current TP configuration
   - Response: `{ success: boolean, config?: TpConfigData }`

2. **POST** `/api/tp/config` - Save TP configuration
   - Body: `{ config: string (TOML), metadata: TpConfigData }`
   - Response: `{ success: boolean, configPath?: string, error?: string }`

3. **POST** `/api/tp/validate-path` - Validate Bitcoin Core socket path
   - Body: `{ path: string }`
   - Response: `{ valid: boolean, exists?: boolean, error?: string }`

4. **GET** `/api/tp/status` - Get TP status (already exists)
   - Response: `{ running: boolean, pid?: number, uptime?: number, config_file?: string }`

5. **POST** `/api/tp/start` - Start Template Provider (already exists)
   - Response: `{ success: boolean, pid?: number, error?: string }`

## Configuration Format

The component generates TOML configuration in this format:

```toml
# sv2-tp (Template Provider) Configuration
# Generated by JD-Client GUI

[bitcoin_core]
url = "/bitcoin-ipc-testnet/node.sock"
network = "testnet"

[template_provider]
listen_address = "0.0.0.0:48442"

[fee_settings]
check_interval = 30
min_fee_rate = 1000

[logging]
level = "info"
```

## Types

### TpConfigData

```typescript
interface TpConfigData {
  bitcoin_source: 'integrated-mainnet' | 'integrated-testnet' | 'host-custom';
  custom_path?: string;
  network: 'mainnet' | 'testnet' | 'signet' | 'regtest';
  listen_address: string;
  fee_check_interval: number;
  min_fee_rate: number;
  log_level: 'trace' | 'debug' | 'info' | 'warn' | 'error';
}
```

## Styling

The component uses CSS patterns consistent with SetupWizard.css:
- Clean form layouts with proper spacing
- Responsive design (mobile-friendly)
- Disabled states for inputs when TP is running
- Status badges and message notifications
- Radio button groups with hover effects

## Integration with App

To add to the main application, update your routing/navigation:

```tsx
import { TpConfig } from './components/TpConfig';

// In your router or navigation
<Route path="/tp-config" element={<TpConfig />} />
```

Or add as a tab/section in your existing layout.

## Notes

- The component automatically disables editing when Template Provider is running
- Path validation happens in real-time when a custom path is entered
- Network is automatically set based on integrated container selection
- Configuration preview shows all settings before saving
- Save button is disabled while TP is running to prevent conflicts
